<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Canvas: Physics and Keyboard Handling</title>
  <meta name="description" content="Previously, we had gone over Javascript Animation Basics. In this tutorial, we will make our ball bounce around inside of the canvas element. We will also us...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://tutorialsbynick.com/canvas-physics-and-keyboard/">
  <link rel="alternate" type="application/rss+xml" title="Tutorials By Nick" href="http://tutorialsbynick.com/feed.xml">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"> 
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-79125896-1', 'auto');
ga('send', 'pageview');
</script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Tutorials By Nick</a>

    <nav class="site-nav">
      <div class="trigger">
        
          
          <a class="page-link" href="/">About</a>
          
        
          
        
          
        
          
        
          <a class="page-link" href="/articles">Articles</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Canvas: Physics and Keyboard Handling</h1>
    <p class="post-meta post-line">
        By <a class="author" href="/about"><span itemprop="author" itemscope
        itemtype="http://schema.org/Person"><span itemprop="name">Nicholas Day</span></span></a>
        &nbsp;|&nbsp;&nbsp;<time datetime="2017-09-14T00:00:00-04:00" itemprop="datePublished">Sep 14, 2017</time>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Previously, we had gone over <a href="/javascript-animation-basics/">Javascript Animation Basics</a>. In this tutorial, we will make our ball bounce around inside of the canvas element. We will also use the keyboard to control the movement of the ball. Let’s get to it!</p>

<h1 id="table-of-contents">Table of Contents</h1>
<ul id="markdown-toc">
  <li><a href="#table-of-contents" id="markdown-toc-table-of-contents">Table of Contents</a></li>
  <li><a href="#physics" id="markdown-toc-physics">“Physics”</a></li>
  <li><a href="#keyboard-handling" id="markdown-toc-keyboard-handling">Keyboard Handling</a></li>
  <li><a href="#advanced-keyboard-handling" id="markdown-toc-advanced-keyboard-handling">Advanced Keyboard Handling</a></li>
</ul>

<h1 id="physics">“Physics”</h1>

<p>Our goal here is for the ball to change velocity when it hits the side of the canvas rather than keep going off infinitely. Because we have a <code>x</code> and <code>y</code> coordinate position for the ball, we can determine when it has gone past the boundaries of the canvas. For this we will use <code>if</code> statements to check whether the ball is outside of the canvas. We also create two variables called <code>vx</code> and <code>vy</code> which is the velocity of the ball in the x and the y axis respectively. <code>if</code> statements are read in your head like <code>if</code> <code>(condition)</code> is true then run the code inside of the <code>{}</code>’s.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">vy</span> <span class="o">=</span> <span class="mi">10</span>
<span class="kd">var</span> <span class="nx">vx</span> <span class="o">=</span> <span class="mi">10</span>

<span class="kd">function</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">vx</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">vy</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vx</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vx</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vy</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vy</span>
    <span class="p">}</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">closePath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">fill</span><span class="p">()</span>
    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">draw</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">draw</span><span class="p">()</span></code></pre></figure>

<p>Now the ball should bounce back after hitting the edge of the screen! :) But, it keeps going past the other side now. :( What we need to do is check if the ball has gone past the top left corner of the screen which is <code>(0, 0)</code>. We can change the <code>if</code> statements to say <code>if</code> the ball is past the bottom right corner, or <code>if</code> the ball is past the top left corner, change the velocity. We do that by changing our condition to <code>(past bottom right corner || past top left corner)</code>.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">vx</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vx</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">vy</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vy</span>
<span class="p">}</span></code></pre></figure>

<p>Yay! It should bounce back and forth now. :)</p>

<h1 id="keyboard-handling">Keyboard Handling</h1>

<p>Now, let’s modify our program to use the keyboard to control the movement of the ball. Take out where the velocity is automatically added to the position of the ball because we want the keyboard to handle that.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">vy</span> <span class="o">=</span> <span class="mi">10</span>
<span class="kd">var</span> <span class="nx">vx</span> <span class="o">=</span> <span class="mi">10</span>

<span class="kd">function</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vx</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vx</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vy</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vy</span>
    <span class="p">}</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">closePath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">fill</span><span class="p">()</span>
    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">draw</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">draw</span><span class="p">()</span></code></pre></figure>

<p>Next, we add an event listener to the html page. We do that with the <code>document.addEventListener()</code> function. It takes the event name as input, along with the function that you want it to run every time that event happens. For us, we would use the <code>keydown</code> event because we want to be able to tell when a key on the keyboard has been pressed. That looks like this:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
<span class="p">})</span></code></pre></figure>

<p>The function provided to <code>document.addEventListener()</code> takes the event as an argument. This event has information like what key was pressed, which we can use to determine whether to move the ball left, right, up, or down. <code>console.log</code> takes any kind of input and prints this out to the browser’s console. To see the console, right click on the webpage, click <code>Inspect</code>, then click <code>Console</code>. What you log with <code>console.log()</code> should show up in the window that pops up.</p>

<p>So, you might be wondering… Nick, how do we tell what key we pressed? Good question :) We can use those <code>if</code> statements that we just learned to tell what the key is named. Go back to your webpage and press keys. You should notice in the console there is a <code>event.key</code> variable. When you press the left arrow key, <code>event.key</code> is <code>ArrowLeft</code>. For the right arrow key, <code>event.key</code> is <code>ArrowRight</code>. <code>ArrowUp</code> for the up arrow key, and you guessed it <code>ArrowDown</code> for the down arrow key.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowRight&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;right key pressed&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowLeft&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;left key pressed&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowUp&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;up key pressed&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowDown&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;down key pressed&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">})</span></code></pre></figure>

<p>We use <code>==</code> rather than <code>=</code> because <code>==</code> checks if two things are equal, and <code>=</code> changes a variable. In the console you should see the “left key pressed” when you press the left arrow key, “up key pressed” for the up arrow key, etc.</p>

<p>So then, we can directly change the position inside of this event listener we created:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">vy</span> <span class="o">=</span> <span class="mi">10</span>
<span class="kd">var</span> <span class="nx">vx</span> <span class="o">=</span> <span class="mi">10</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowRight&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">vx</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowLeft&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">-</span> <span class="nx">vx</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowUp&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">-</span> <span class="nx">vy</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowDown&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">vy</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="kd">function</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vx</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vx</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vy</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vy</span>
    <span class="p">}</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">closePath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">fill</span><span class="p">()</span>
    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">draw</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">draw</span><span class="p">()</span></code></pre></figure>

<h1 id="advanced-keyboard-handling">Advanced Keyboard Handling</h1>

<p>Wowzers! Your code should now let you move the circle around the canvas! But wait… when you press and hold down an arrow key, the movement is jerky and doesn’t look as nice as it should. Also, you can’t press two keys at the same time to move the circle. You can only move the circle in one direction at a time. :( Let’s fix that. What we want is to move the circle when a key is pressed in that direction and stop moving the object when the key is released. We can use the <code>keyup</code> event to tell when the key has been released. :) Isn’t the browser great? So what we can do is say hey this key is pressed inside of a variable when the <code>keydown</code> event fires and change that variable to say the key is not pressed when we get the <code>keyup</code> event.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">leftPressed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nx">rightPressed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nx">upPressed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nx">downPressed</span> <span class="o">=</span> <span class="kc">false</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowRight&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rightPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowLeft&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">leftPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowUp&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">upPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowDown&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">downPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keyup&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowRight&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rightPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowLeft&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">leftPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowUp&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">upPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowDown&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">downPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">})</span></code></pre></figure>

<p>You should see that we are using these weird true and false values rather than numbers or strings. <code>true</code> and <code>false</code> are boolean values. For a boolean variable, its value can be either <code>true</code> or <code>false</code>, and we can use them in <code>if</code> statements. So <code>if</code> <code>leftPressed</code> is <code>true</code>, then subtract the x velocity from the ball’s position. <code>if</code> <code>rightPressed</code> is <code>true</code> add the x velocity to the ball’s position, and so on for up and down. We put this inside of the <code>draw()</code> function because we want it to run every time the ball is drawn. We can’t use the <code>keyup</code> and <code>keydown</code> events because they only run when the key is first pressed up or released and then infrequently. We want smooth motion while the key is pressed.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">vx</span> <span class="o">=</span> <span class="mi">10</span>
<span class="kd">var</span> <span class="nx">vy</span> <span class="o">=</span> <span class="mi">10</span>

<span class="kd">var</span> <span class="nx">leftPressed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nx">rightPressed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nx">upPressed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nx">downPressed</span> <span class="o">=</span> <span class="kc">false</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keydown&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowRight&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rightPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowLeft&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">leftPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowUp&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">upPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowDown&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">downPressed</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keyup&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowRight&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">rightPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowLeft&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">leftPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowUp&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">upPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">key</span> <span class="o">==</span> <span class="s2">&quot;ArrowDown&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">downPressed</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="kd">function</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vx</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vx</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">myCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vy</span> <span class="o">=</span> <span class="o">-</span><span class="nx">vy</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">leftPressed</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">-</span> <span class="nx">vx</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">rightPressed</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">vx</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">upPressed</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">-</span> <span class="nx">vy</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">downPressed</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">vy</span>
    <span class="p">}</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">closePath</span><span class="p">()</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">fill</span><span class="p">()</span>
    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">draw</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">draw</span><span class="p">()</span></code></pre></figure>

<p>Fantastic job! Now your ball should be controllable by your arrow keys. :)</p>




<div class="center intro-above"><h1>Join me in learning about how computers work</h1></div>

<p>Just enter your email into the box below. You'll also receive my free 12 page
guide, <i>Getting Started with Operating System Development</i>, straight to your
inbox just for subscribing.</p>

<div class="intro-above intro">
<div class="float-left">
<img class="guide-image" alt="Getting Started with Operating System Development Ebook"
     src="/images/osdev-book-cover.jpg" />
</div>

<div class="float-left">
<!-- Begin MailChimp Signup Form -->
<div id="mc_embed_signup">
<form action="//tutorialsbynick.us13.list-manage.com/subscribe/post?u=99cb9d82916998aa9e5915fa3&amp;id=65aafcd362" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<h3>Where do I send your free guide to?</h3>
<div class="mc-field-group">
	<input type="email" value="" placeholder="Email Address" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_99cb9d82916998aa9e5915fa3_65aafcd362" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" style="margin-top: 10px;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
</div>
</div>
<div class="clear"></div>


  </div>


  
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = "http://tutorialsbynick.com/canvas-physics-and-keyboard/";
        this.page.identifier = "Canvas: Physics and Keyboard Handling";
    };
(function() {
        var d = document, s = d.createElement('script');
        
        s.src = '//tutorialsbynick.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Tutorials By Nick</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Tutorials By Nick</li>
          <li><a href="mailto:nick@tutorialsbynick.com">nick@tutorialsbynick.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/nicholasday"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">nicholasday</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/nicholasbday"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">nicholasbday</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I like to learn how computers work and share my knowledge in my newsletter.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
